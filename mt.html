<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MT4 demo</title>
    <script src="https://bundle.run/buffer"></script>
  </head>
  <body>
    <marquee>MT4 demo</marquee>
    <script>
      const ws = new WebSocket('wss://gwt10.mql5.com/');

      ws.onopen = () => {
        console.log('Open connection!');

        function base64ToArrayBuffer(base64) {
          const binary_string = window.atob(base64);
          const len = binary_string.length;
          const bytes = new Uint8Array(len);
          for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
          }
          return bytes.buffer;
        }

        const req1 =
          'UAAAAAEAAADBOyujV+sl9IcGEWqrwm8d03NC6PUfo7xteAbprcqKGhxnCxsl85xvGc2M1dbL/MHJ05Z02DesTIye3lhw4qidSKy+ShkLlS74fUoGGPWc2A==';

        const req2 =
          'YAAAAAEAAADedvS0v1uiKN/5SnM8m0ehUxfbjplPjtkZUHaDXoS/47lgHsezlFVn8DDsrEQLtoxdQB1QHFycht0DKCfuKFu+iWk3J8ieudKdWCimJKlE9wb/qJRDVexLJDfr3Uy1SnA=';

        const req3 = 'EAAAAAEAAADDSYIj21Zj3cHAGT6jVgL3';

        ws.send(base64ToArrayBuffer(req1));
        ws.send(base64ToArrayBuffer(req2));
        ws.send(base64ToArrayBuffer(req3));
      };

      ws.onclose = ({ reason }) => {
        console.log('Close connection, reason: ', reason);
      };

      ws.onerror = (e) => {
        console.log('WebSocket error: ', e);
      };

      ws.onmessage = async ({ data }) => {
        console.log(data);
      };
    </script>
  </body>
</html>
